# ะะทะฒะตััะฝะพ, ััะพ ะณะตะฝะตัะฐะปัะฝะฐั ัะพะฒะพะบัะฟะฝะพััั ัะฐัะฟัะตะดะตะปะตะฝะฐ ะฝะพัะผะฐะปัะฝะพ ัะพ ััะตะดะฝะธะผ ะบะฒะฐะดัะฐัะธัะฝัะผ  5. 
# ะะฐะนัะธ ะดะพะฒะตัะธัะตะปัะฝัะน ะธะฝัะตัะฒะฐะป ะดะปั ะพัะตะฝะบะธ ััะตะดะฝะตะณะพ ะฐัะธัะผะตัะธัะตัะบะพะณะพ ั ะฝะฐะดะตะถะฝะพัััั 0,95, 
# ะตัะปะธ ะฒัะฑะพัะพัะฝะฐั ััะตะดะฝัั ะ = 24.15, ะฐ ะพะฑัะตะผ ะฒัะฑะพัะบะธ 100.

# ะฅยฬ  ยฑ ๐_(๐ผ/2) โ ๐/โ๐

X  = 24.15
Z = 1.96
๐ = 5
๐ = 100

print(f'[{round(X - Z * ๐ / (n)**0.5, 2)}; {round(X + Z * ๐ / (n)**0.5, 2)}]') #[23.17; 25.13]

###################################################################################

# ะะฐะฝะฐ ะฒัะฑะพัะบะฐ, ัะพััะพััะฐั ะธะท ัะพััะฐ 10 ัะตะปะพะฒะตะบ. ะัะตะฝะธัั ััะตะดะฝะธะน ัะพัั ะฒ ะดะฐะฝะฝะพะน ะฟะพะฟัะปััะธะธ ั ะฟะพะผะพััั 95% ะธะฝัะตัะฒะฐะปะฐ.
# [178, 184, 149, 193, 186, 173, 169, 175, 159, 174]

# ะฅ ยฑ ๐ก_(๐ผ/2) โ ๐/โ๐

import numpy as np
from scipy import stats


a = np.array([178, 184, 149, 193, 186, 173, 169, 175, 159, 174])
n = 10
X = np.mean(a) # 174.0
๐ = np.std(a, ddof=1) # 12.90
D = np.var(a, ddof=1) # 166.44
#t = 2.262 # ะฟะพ ัะฐะฑะปะธัะต ะดะปั ะฐะปััะฐ 0.975 ะธ ััะตะฟะตะฝั ัะฒะพะฑะพะดั 10-1=9 ะะะ
t = stats.t.ppf(0.975, 9) # 2.262

print(f'[{round(X - t * ๐ / (n)**0.5, 2)}; {round(X + t * ๐ / (n)**0.5, 2)}]') # [164.77; 183.23]
print(f'[{round(X - t * np.sqrt(D/10), 2)}; {round(X + t * np.sqrt(D/10), 2)}]') # [164.77; 183.23]

print(X, t, ๐, D)

############################################################################

# ะัะตะฝะธัั ัะฐะทะปะธัะธะต ะฒ ัะพััะต ะผะตะถะดั ะดะฒัะผั ััะตะดะฝะธะผะธ ะฐัะธัะผะตัะธัะตัะบะธะผะธ ะฟะพะฟัะปััะธะธ 
# a  ะธ b ั ะฟะพะผะพััั 95% ะดะพะฒะตัะธัะตะปัะฝะพะณะพ ะธะฝัะตัะฒะฐะปะฐ.
# a [178, 184, 149, 193, 186, 173, 169, 175, 159, 174]
# b [150, 154, 167, 165, 171, 150, 158, 170, 175, 160]

# ฮ ยฑ ๐ก_(๐ผ/2)โ ๐_ฮ , ะณะดะต ฮ = (๐_1)ย- (๐_2)ย
# ๐ท = 1/2(๐ท_1 + ๐ท_2), ะณะดะต ๐ท_1 ะธ ๐ท_2 โ ะดะธัะฟะตััะธะธ ะพะฑะตะธั ะณััะฟะฟ
# ๐_ฮ = โ(๐ท/๐_1 +๐ท/๐_2 ), ะณะดะต ๐_1 ะธ  ๐_2 โ ะพะฑัะตะผั ะฒัะฑะพัะพะบ.
# ๐๐ = 2โ(๐โ1), ะณะดะต n - ะพะฑัะตะผ ะฒัะฑะพัะบะธ

import numpy as np
from scipy import stats

a = np.array([178, 184, 149, 193, 186, 173, 169, 175, 159, 174])
b = np.array([150, 154, 167, 165, 171, 150, 158, 170, 175, 160])
n_1 = len(a) # 10
n_2 = len(b) # 10
X_1 = np.mean(a) # 174.0
X_2 = np.mean(b) # 162.0
ฮ = X_1 - X_2 # 12
D_1 = np.var(a, ddof=1) # 166.44
D_2 = np.var(b, ddof=1) # 80.0
D = (๐ท_1 + ๐ท_2) / 2 # 123.22
SE = np.sqrt(D/n_1 + D/n_2) # 4.964
#t = 2.101 # ะฟะพ ัะฐะฑะปะธัะต ะดะปั ะฐะปััะฐ 0.975 ะธ ััะตะฟะตะฝั ัะฒะพะฑะพะดั 2*(10-1)=18
t = stats.t.ppf(0.975, 18) # 2.101

print(f'[{round(ฮ - t * SE, 2)}; {round(ฮ + t * SE, 2)}]') # [1.57; 22.43]

##################################################################################

#  ฯ = โ(๐(1โ๐))
# ๐๐ธ= โ((๐(1โ๐))/๐)
# ะญัะธะผ ะฟัะธะฑะปะธะถะตะฝะธะตะผ ะผั ะฟะพะปัะทัะตะผัั, ะบะพะณะดะฐ ๐โ๐ยฬ  ะธ ๐โ(1โ๐ยฬ) ะฑะพะปััะต 5. ะญัะพ ััะฒะตัะถะดะตะฝะธะต ะฝะฐัััะฐะตััั ะฟัะธ ะผะฐะปะตะฝัะบะธั ะพะฑัะตะผะฐั ะฒัะฑะพัะบะธ ะธ ๐  ะฑะปะธะทะบะธั ะบ 0 ะธะปะธ 1.


# ะ ััะตัะต ะพะฑัะฐะทะพะฒะฐะฝะธั ัััะฐะฝั X ัะฐะฑะพัะฐัั 20% ะถะตะฝัะธะฝ ะธ 80% ะผัะถัะธะฝ. ะะฐัััะธัะฐัั ััะฐะฝะดะฐััะฝะพะต ะพัะบะปะพะฝะตะฝะธะต ะดะปั ะดะพะปะธ  p = 0.2
# ฯ = โ(0.2 (1โ0.2)) = 0.4
# ะ ััะพ ะฑัะดะตั, ะตัะปะธ   p = 0.5?
# ฯ = โ(0.5 (1โ0.5)) = 0.5, 
# ะดะปั p = 0 (ะฒ ะบะพะปะปะตะบัะธะฒะต ะฒะพะพะฑัะต ะฝะตั  ะถะตะฝัะธะฝ, ะพะดะฝะธ ะผัะถัะธะฝั)
# ฯ = โ(0 (1โ0)) = 0
# ะดะปั  p = 1 (ะบะพะปะปะตะบัะธะฒะต ะฒัะต ะถะตะฝัะธะฝั ะธ ัะพะฒัะตะผ ะฝะตั ะผัะถัะธะฝ)
# ฯ = โ(1 (1โ1)) = 0

##################################################################################################

# ะะพัััะพะธัั  95% ะดะพะฒะตัะธัะตะปัะฝัะน ะธะฝัะตัะฒะฐะป ะดะปั ะธััะธะฝะฝะพะณะพ ๐ โ ะดะพะปะธ ะฝะพัะธัะตะปะตะน ะฝะตะบะพัะพัะพะณะพ ะณะตะฝะฐ. ะะฑัะตะผ ะฒัะฑะพัะบะธ 100. ะะพะปั ะฝะพัะธัะตะปะตะน ะฒ ะฒัะฑะพัะบะต ัะพััะฐะฒะปัะตั 0.2

# 100 * 0.2 = 20 ะธ 100 * (1-0.2) = 80 , ะพะฑะฐ ะทะฝะฐัะตะฝะธั > 5

ฯ = np.sqrt(0.2*(1-0.2))
print(ฯ) #0.4

SE = np.sqrt(0.2*(1-0.2) / 100)
print(SE) #0.04

# p ยฑ ๐_(๐ผ/2) โ SE

Z = 1.96 # ะดะปั ๐ผ = 0.05/2 = 0.025

print(f'[{round(0.2 - Z * SE, 2)}; {round(0.2 + Z * SE, 2)}]') #[0.12; 0.28]

################################################################################################

# ะัะปะธ ะฝะต ะฒัะฟะพะปะฝััััั ััะปะพะฒะธั ๐โ๐ยฬ > 5 ะธ ๐โ(1 โ ๐ยฬ)  > 5, ะธัะฟะพะปัะทััั ะฑะธะฝะพะผะธะฐะปัะฝะพะต ัะฐัะฟัะตะดะตะปะตะฝะธะต.
# ัะพัะผัะปะฐ ะะตัะฝัะปะปะธ:
# ะก_๐^๐ โ ๐^๐ โ ๐^(๐โ๐)   


# ะะธ ั ะพะดะฝะพะณะพ ะธะท 30 ะฟะฐัะธะตะฝัะพะฒ ะฟัะตะฟะฐัะฐั ะฝะต ะฒัะทะฒะฐะป ะฟะพะฑะพัะฝะพะณะพ ัััะตะบัะฐ.  ะัะตะฝะธัั ะธััะธะฝะฝัั 
# ะดะพะปั ะฟะฐัะธะตะฝัะพะฒ ะฒ ะฟะพะฟัะปััะธะธ, ั ะบะพัะพััั ะฟัะตะฟะฐัะฐั ะฒัะทะพะฒะตั  ะฟะพะฑะพัะฝัะน ัััะตะบั.

# ะะตัะตะฝะธะต ั ะฟะพะผะพััั ะณัะฐัะธัะตัะบะพะณะพ ะผะตัะพะดะฐ
#  ๐ยฬ=0/30=0
#  ะพั 0 ะดะพ 0.13 
#  ะฒ ะฟัะพัะตะฝัะฐั ะพั 0% ะดะพ 13%

###############################################################################################

# ะฃ 1 ะธะท 5 ะฟะฐัะธะตะฝัะพะฒ, ะฟัะธะฝะธะผะฐะฒัะธั ััะฐััะธะต ะฒ ะบะปะธะฝะธัะตัะบะธั ะธััะปะตะดะพะฒะฐะฝะธัั, ะฟัะตะฟะฐัะฐั ะฒัะทะฒะฐะป ะฟะพะฑะพัะฝัะน ัััะตะบั. ะัะตะฝะธัั ะธััะธะฝะฝะพะต ะทะฝะฐัะตะฝะธะต ะดะพะปะธ ะฟะฐัะธะตะฝัะพะฒ ะฒ ะฟะพะฟัะปััะธะธ, 
# ั ะบะพัะพััั ะฟัะตะฟะฐัะฐั ะฒัะทะพะฒะตั ะฟะพะฑะพัะฝัะน ัััะตะบั.
# ๐โ๐ = 5โ 0.2= 1
# 1<5
# ะก_๐^๐โ๐^๐โ๐^(๐โ๐)

# 0.32768 + 0.4096 + 0.2048 = 0.94208 
# 94% ะธะฝัะตัะฒะฐะป ัะพััะฐะฒะปัะตั 0 โ 0.4

##############################################################################################

# ะััั ะดะฒะต ะณััะฟะฟั ัััะดะตะฝัะพะฒ ะพะฑัะตะผะพะผ 56 ะธ 61, ะบะพัะพััะต ัะดะฐัั ะผะตะถะดัะฝะฐัะพะดะฝัะน ัะบะทะฐะผะตะฝ ะฝะฐ ะทะฝะฐะฝะธะต ะธะฝะพัััะฐะฝะฝะพะณะพ ัะทัะบะฐ. 
# ะะฐะบัะธะผะฐะปัะฝะพะต ัะธัะปะพ  ะฑะฐะปะปะพะฒ ะทะฐ ัะตัั 120. ะััะพะบะฐั ะพัะตะฝะบะฐ ััะธัะฐะตััั ะฒััะต 100 ะฑะฐะปะปะพะฒ. 
# ะ ะฟะตัะฒะพะน ะณััะฟะฟะต ะฒััะพะบัั ะพัะตะฝะบั ะฟะพะปััะธะปะธ  7 ัััะดะตะฝัะพะฒ, ะฐ ะฒะพ ะฒัะพัะพะน 22. 
# ะััั ะปะธ ััะฐัะธััะธัะตัะบะธ ะทะฝะฐัะธะผัะต ัะฐะทะปะธัะธั ะฒ ะดะพะปัั ัััะดะตะฝัะพะฒ ััะธั ะดะฒัั ะณััะฟะฟ, ัะดะฐะฒัะธั ัะตัั ะฝะฐ ะฒััะพะบะธะน ะฑะฐะปะป.

# ๐ง=  (๐ยฬ_1โ๐ยฬ_2)/โ(๐(1โ๐)(1/๐_1 +1/๐_2 ) ), ะณะดะต 
# ๐=(๐_1+๐_2)/(๐_1+๐_2 )  ,

#  ะัะธัะตัะธะน Z ั ะฟะพะฟัะฐะฒะบะพะน ะะตะนััะฐ ะฝะฐ ะฝะตะฟัะตััะฒะฝะพััั:
# ๐ง=(|๐ยฬ_1โ ๐ยฬ_2 |โ 1/2(1/๐_1 +1/๐_2 ))/โ(๐(1โ๐)โ (1/๐_1 +1/๐_2 ))

# ๐_1=56      ๐_1=7     (๐)_1=  7/56
# ๐_2=61      ๐_2=22    (๐)_2=  22/61
# ๐ยฬ=(7+22)/(56+61)=29/117 

# ๐ง=(|7/56โ22/61|โ1/2(1/56+1/61))/โ(29/117(1โ29/117)โ(1/56+1/61))โ2.725

############################################################################################

# ะะฐ ะพะดะฝะพะผ ัะฐะนัะต ะธะท 153 ะฟะพัะตัะธัะตะปะตะน 75  ะพัะพัะผะธะปะธ ะทะฐะบะฐะท, ะฐ ะฝะฐ ะดััะณะพะผ ัะฐะนัะต ะธะท 120 ะฟะพัะตัะธัะตะปะตะน ะทะฐะบะฐะท ะพัะพัะผะธะปะธ 50 ัะตะปะพะฒะตะบ. 
# ะัะตะฝะธัั ั ะฟะพะผะพััั ะดะพะฒะตัะธัะตะปัะฝะพะณะพ ะธะฝัะตัะฒะฐะปะฐ ัะฐะทะฝะพััั ะดะพะปะตะน ะฟะพะบัะฟะฐัะตะปะตะน, ัะพะฒะตััะธะฒัะธั ะฟะพะบัะฟะบั.

# (๐_1 )ยฬ=75/153=0.490,
# (๐_2 )ยฬ=  50/120=0.417

# ฮ=0.490โ0.417 = 0.073
# ๐_ฮ=โ(๐_ะพะฑั (1โ๐_ะพะฑั )(1/๐_1 +1/๐_2 ) )=
#  =โ(0.458โ(1โ0.458)(1/153+1/120) )=0.06

# 0.073ยฑ1.96*0.06    โ  [ -0.045;  0.009]

########################################################################################################3

# ะะฐ ะฟัะตะฟะฐัะฐัะต ะ ะฟะพะปะพะถะธัะตะปัะฝัะน ัะตะทัะปััะฐั ะปะตัะตะฝะธั ะฝะฐะฑะปัะดะฐะตััั ั 17 ะธะท 32 ะฟะฐัะธะตะฝัะพะฒ, ะฐ 
# ะฝะฐ ะฟัะตะฟะฐัะฐัะต ะ ั 9 ะธะท 22. ะะพัััะพะธัั 95% ะดะพะฒะตัะธัะตะปัะฝัะน ะธะฝัะตัะฒะฐะป ะดะปั ัะฐะทะฝะพััะธ ะดะพะปะตะน.
# ะะฑะฝะฐััะถะตะฝั ะปะธ ััะฐัะธััะธัะตัะบะธ ะทะฝะฐัะธะผัะต ัะฐะทะปะธัะธั?

P_1 = 17/32
P_2 = 9/22
P = (17+9) / (32+22) # 0.481
S = np.sqrt(P*(1-P)*(1/32 + 1/22)) # 0.1384
delta = P_1 - P_2
Z = 1.96 # ะดะปั ๐ผ = 0.05/2 = 0.025

print(f'[{round(delta - Z*S, 2)}; {round(delta + Z*S, 2)}]') # [-0.15; 0.39]

# ะัะฒะตั: ััะฐัะธััะธัะตัะบะธ ะทะฝะฐัะธะผัะต ัะฐะทะปะธัะธั ะฝะต ะพะฑะฝะฐััะถะตะฝั

####################################################################################

# ะะตัะธัั ะทะฐะดะฐัั 1 ัะตัะตะท ัะตััะธัะพะฒะฐะฝะธะต ะณะธะฟะพัะตะทั.
# ะะฐ ะฟัะตะฟะฐัะฐัะต ะ ะฟะพะปะพะถะธัะตะปัะฝัะน ัะตะทัะปััะฐั ะปะตัะตะฝะธั ะฝะฐะฑะปัะดะฐะตััั ั 17 ะธะท 32 ะฟะฐัะธะตะฝัะพะฒ, ะฐ 
# ะฝะฐ ะฟัะตะฟะฐัะฐัะต ะ ั 9 ะธะท 22. ะฏะฒะปััััั ะปะธ ัะฐะทะปะธัะธั ััะฐัะธััะธัะตัะบะธ ะทะฝะฐัะธะผัะต ะผะตะถะดั ะดะพะปัะผะธ 
# ะฟะฐัะธะตะฝัะพะฒ ั ะฟะพะปะพะถะธัะตะปัะฝัะผ ัััะตะบัะพะผ ะฒ ััะธั ะดะฒัั ะณััะฟะฟะฐั.
# ะฃัะพะฒะตะฝั ััะฐัะธััะธัะตัะบะพะน ะทะฝะฐัะธะผะพััะธ ะฟัะธะฝััั ะทะฐ 0.05

# ะกัะฐะฒะฝะตะฝะธะต ะดะพะปะตะน 

P_1 = 17/32
P_2 = 9/22
P = (17+9) / (32+22) # 0.481

Z = (abs(P_1-P_2) - (1/2)*(1/32 + 1/22)) / np.sqrt(P*(1-P) * (1/32 + 1/22))
print(Z) # 0.606

Zั = 1.96

# ะัะฒะตั: Z ะฟะพะฟะฐะดะฐะตั ะฒ Zั, ะฟัะธะฝะธะผะฐะตะผ 0-ั ะณะธะฟะพัะตะทั, ััะฐัะธััะธัะตัะบะธ ะทะฝะฐัะธะผัะต ัะฐะทะปะธัะธั ะฝะต ะพะฑะฝะฐััะถะตะฝั

##################################################################################

# ะัะปะพ ะฟัะพะฒะตะดะตะฝะพ ะธััะปะตะดะพะฒะฐะฝะธะต ะฝะฐััะฝัั ััะฐัะตะน ะฝะฐ ะบะพะปะธัะตััะฒะพ ะฐะฒัะพัะพะฒ ะฒ ัะฐะทะฝัะต ะณะพะดั. 
# ะะพัััะพะธัั 90% ะธ 95% ะธะฝัะตัะฒะฐะปั 
# ะะธััะฝะพะบ

# ะะพะฒะตัะธัะตะปัะฝัะน ะธะฝัะตัะฒะฐะป ะดะปั ััะตะดะฝะธั ะฐัะธัะผะตัะธัะตัะบะธั

# 95%: Zั = 1.96
# 90%: Zั = 1.645

print(f'[{round(2 - 1.645*1.4/np.sqrt(151), 2)}; {round(2 + 1.645*1.4/np.sqrt(151), 2)}]') # 1946ะณ. 90% [1.81; 2.19]
print(f'[{round(2 - 1.96*1.4/np.sqrt(151), 2)}; {round(2 + 1.96*1.4/np.sqrt(151), 2)}]') # 1946ะณ.95% [1.78; 2.22]

print(f'[{round(2.3 - 1.645*1.6/np.sqrt(149), 2)}; {round(2.3 + 1.645*1.6/np.sqrt(149), 2)}]') # 1956ะณ. 90% [2.08; 2.52]
print(f'[{round(2.3 - 1.96*1.6/np.sqrt(149), 2)}; {round(2.3 + 1.96*1.6/np.sqrt(149), 2)}]') # 1956ะณ.95% [2.04; 2.56]















